<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kerst Pictionary Deluxe</title>
    <link href="https://fonts.googleapis.com/css2?family=Mountains+of+Christmas:wght@700&family=Nunito:wght@400;700;900&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --xmas-red: #b01c1e;
            --xmas-dark-red: #6d0f11;
            --xmas-gold: #f8b229;
            --xmas-gold-dark: #a8781a;
            --xmas-green: #165b33;
            --text-light: #f0f4f8;
        }

        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(rgba(20, 40, 20, 0.9), rgba(40, 10, 10, 0.9)), url('https://images.unsplash.com/photo-1543589077-47d81606c1bf?q=80&w=2000&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            color: var(--text-light);
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
            user-select: none;
        }

        /* Sneeuw */
        .snowflake { position: absolute; top: -20px; color: rgba(255,255,255,0.6); animation: fall linear forwards; pointer-events: none; }
        @keyframes fall { to { transform: translateY(105vh) rotate(360deg); } }

        /* Container */
        .container {
            background: linear-gradient(145deg, rgba(180, 30, 50, 0.95), rgba(100, 20, 30, 0.98));
            border-radius: 30px;
            box-shadow: 0 30px 60px rgba(0,0,0,0.6), 0 0 0 5px rgba(168, 120, 26, 0.5);
            border: 6px solid transparent;
            border-image: linear-gradient(to bottom right, var(--xmas-gold), var(--xmas-gold-dark), var(--xmas-gold)) 1;
            width: 95%;
            max-width: 900px;
            padding: 30px;
            z-index: 10;
            text-align: center;
            position: relative;
            backdrop-filter: blur(5px);
        }

        h1 {
            font-family: 'Mountains of Christmas', cursive;
            font-size: 3.5rem;
            margin: 0;
            background: linear-gradient(to right, var(--xmas-gold), #fff, var(--xmas-gold));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }

        /* Score Track */
        .score-board {
            display: flex;
            justify-content: space-around;
            background: rgba(0,0,0,0.3);
            border-radius: 15px;
            padding: 10px;
            margin: 15px 0;
            border: 2px solid rgba(255,255,255,0.1);
        }
        .team-score { font-size: 1.2rem; font-weight: bold; }
        .score-number { color: var(--xmas-gold); font-size: 1.5rem; margin-left: 5px; }

        /* Canvas Area */
        .canvas-wrapper {
            background: #fff;
            border-radius: 15px;
            border: 4px solid var(--xmas-gold);
            margin: 10px auto;
            cursor: crosshair;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.1);
        }

        canvas { display: block; touch-action: none; }

        /* Toolbar */
        .toolbar { display: flex; justify-content: center; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
        .color-btn {
            width: 35px; height: 35px; border-radius: 50%; border: 2px solid white; cursor: pointer;
            transition: transform 0.2s; box-shadow: 0 3px 5px rgba(0,0,0,0.3);
        }
        .color-btn:hover, .color-btn.active { transform: scale(1.2); border-color: var(--xmas-gold); }
        .color-black { background: #333; }
        .color-red { background: var(--xmas-red); }
        .color-green { background: var(--xmas-green); }
        .color-gold { background: var(--xmas-gold); }

        /* Timer */
        .timer-bar { width: 100%; height: 10px; background: rgba(0,0,0,0.3); margin-bottom: 10px; border-radius: 5px; overflow: hidden; }
        .timer-fill { height: 100%; width: 100%; background: #2ecc71; transition: width 1s linear; }

        /* Inputs & Buttons */
        input[type="text"] {
            padding: 10px 15px; border-radius: 20px; border: none; width: 60%; 
            margin: 5px; font-size: 1rem; text-align: center; font-weight: bold;
        }

        .btn {
            background: linear-gradient(to bottom, var(--xmas-gold), var(--xmas-gold-dark));
            color: #4a3200; border: 2px solid #fff; padding: 12px 25px;
            font-size: 1.1rem; border-radius: 50px; cursor: pointer; margin: 5px;
            font-weight: 900; box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            font-family: 'Nunito', sans-serif; text-transform: uppercase;
        }
        .btn:hover { transform: translateY(-2px); filter: brightness(1.1); }
        .btn-green { background: linear-gradient(to bottom, #27ae60, #165b33); color: white; border-color: #85e0a3; }
        .btn-red { background: linear-gradient(to bottom, var(--xmas-red), var(--xmas-dark-red)); color: white; border-color: var(--xmas-gold); }
        .btn-small { padding: 8px 15px; font-size: 0.9rem; }

        .word-reveal {
            background: #fff; color: #333; padding: 20px; border-radius: 15px;
            margin: 20px 0; font-size: 2rem; font-weight: 900; border: 3px dashed var(--xmas-gold);
            transform: rotate(-2deg);
        }

        /* Categorie Selectie Stijlen */
        .cat-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 10px;
            margin: 20px 0;
            max-height: 250px;
            overflow-y: auto;
        }
        
        .cat-option {
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            padding: 10px;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
            font-weight: bold;
        }
        
        .cat-option:hover { background: rgba(255,255,255,0.2); }
        
        .cat-option.selected {
            background: linear-gradient(to bottom right, var(--xmas-gold), var(--xmas-gold-dark));
            color: #4a3200;
            border-color: #fff;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .hidden { display: none !important; }
        #confetti-canvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: 100; }

    </style>
</head>
<body>

<canvas id="confetti-canvas"></canvas>

<div class="container">
    <h1>Kerst Pictionary</h1>
    
    <div class="score-board">
        <div class="team-score"><span id="name-t1">Team 1</span>: <span id="score-t1" class="score-number">0</span></div>
        <div class="team-score"><span id="name-t2">Team 2</span>: <span id="score-t2" class="score-number">0</span></div>
    </div>

    <div id="screen-setup">
        <div style="margin-bottom: 20px;">
            <h3 style="margin:5px 0;">Stap 1: Teamnamen</h3>
            <input type="text" id="input-t1" value="De Kerstengels"><br>
            <input type="text" id="input-t2" value="De Sneeuwpoppen">
        </div>

        <div style="border-top: 1px solid rgba(255,255,255,0.2); padding-top:10px;">
            <h3 style="margin:0;">Stap 2: Kies Categorie√´n</h3>
            <div style="font-size:0.8rem; color:#ccc; margin-bottom:5px;">Klik om te selecteren</div>
            
            <div class="cat-grid" id="category-container">
                </div>
            
            <div style="display:flex; gap:10px; justify-content:center;">
                <button class="btn btn-small" style="background:rgba(255,255,255,0.2); border:none;" onclick="toggleAllCats(true)">Alles Aan</button>
                <button class="btn btn-small" style="background:rgba(255,255,255,0.2); border:none;" onclick="toggleAllCats(false)">Alles Uit</button>
            </div>
        </div>
        
        <br>
        <button class="btn btn-green" onclick="startGame()">Start Spel</button>
    </div>

    <div id="screen-preturn" class="hidden">
        <h2 id="turn-msg">... is aan de beurt!</h2>
        <p>De tekenaar mag het woord zien. De rest moet wegkijken!</p>
        <button class="btn btn-gold" onclick="showWord()">Toon Woord aan Tekenaar</button>
        
        <div id="secret-word-area" class="hidden">
            <p style="margin:0; opacity:0.7;">Jouw opdracht is:</p>
            <div class="word-reveal" id="word-display">...</div>
            <p style="font-size:0.9rem;">Klik op start en begin meteen met tekenen!</p>
            <button class="btn btn-green" onclick="startRound()">START & TEKENEN ‚úèÔ∏è</button>
        </div>
    </div>

    <div id="screen-game" class="hidden">
        <div class="timer-bar"><div class="timer-fill" id="timer-fill"></div></div>
        
        <div class="canvas-wrapper">
            <canvas id="drawingBoard" width="700" height="400"></canvas>
        </div>

        <div class="toolbar">
            <div class="color-btn color-black active" onclick="setColor('#333', this)"></div>
            <div class="color-btn color-red" onclick="setColor('#b01c1e', this)"></div>
            <div class="color-btn color-green" onclick="setColor('#165b33', this)"></div>
            <div class="color-btn color-gold" onclick="setColor('#f8b229', this)"></div>
            <button class="btn btn-small" style="background:#fff; color:#333; border:1px solid #ccc;" onclick="clearCanvas()">Gummen</button>
        </div>

        <div style="margin-top: 20px; display: flex; justify-content: center; gap: 20px;">
            <button class="btn btn-red" onclick="endRound(false)">Niet geraden / Tijd om</button>
            <button class="btn btn-green" onclick="endRound(true)">GERADEN! ‚úÖ</button>
        </div>
    </div>

    <div id="screen-winner" class="hidden">
        <h1>Gewonnen!</h1>
        <h2 id="winner-name">...</h2>
        <p>Jullie zijn de ultieme tekenaars!</p>
        <button class="btn btn-gold" onclick="location.reload()">Opnieuw Spelen</button>
    </div>

</div>

<script>
    // === DATA: 8 Categorie√´n met veel woorden ===
    const wordData = {
        "üéÑ Kerst & Winter": [
            "Kerstboom", "Sneeuwpop", "Rudolph", "Arrenslee", "Cadeautje", "Open Haard", "Kerstbal", "Engel", "Ster", "Kaars",
            "Kerk", "Sok", "Zuurstok", "Kalkoen", "Champagne", "Vuurwerk", "Oliebol", "Schaatsen", "Muts", "Sjaal",
            "Want", "Iglo", "Pingu√Øn", "IJsbeer", "Noordpool", "Schoorsteen", "Klok", "Stal", "Ezel", "Herder",
            "Drie Koningen", "Kameel", "Gitaar", "Trommel", "Zingen", "Lichtjes", "Slinger", "Piek", "Diner", "Wijn",
            "Kerstman", "Elf", "Mistletoe", "Hulst", "Kerstkrans", "Postzegel", "Sneeuwbol", "Baard", "Slee", "Jingle Bells",
            "Pakje", "Strik", "Lint", "Inpakpapier", "Surprise", "Gedicht", "Adventskalender", "Chocoladeletter", "Pepernoot",
            "Marsepein", "Gl√ºhwein", "Warme Choco", "Slagroom", "Marshmallow", "Gourmetstel", "Rollade", "Stoofpeer", "Pudding",
            "Sneeuwvlok", "Sneeuwbal", "IJspegel", "Ski√´n", "Snowboard", "Skilift", "Chalet", "Haardvuur", "Houtblok", "Winterjas",
            "Oorwarmers", "Vorst", "Mist", "Wak", "Kettingzaag", "Sneeuwschuiver", "Strooiwagen", "Ruitenkrabber", "Thermometer", "IJsblokje", "Kachel"
        ],
        "ü¶Å Dieren": [
            "Hond", "Kat", "Hamster", "Konijn", "Vis", "Vogel", "Duif", "Eend", "Zwaan", "Uil", "Roodborstje", "Meeuw", "Mus",
            "Vos", "Wolf", "Beer", "Hert", "Ree", "Eland", "Eekhoorn", "Egel", "Muis", "Rat", "Vleermuis", "Spin", "Web", "Vlinder", "Bij",
            "Lieveheersbeestje", "Slak", "Kikker", "Schildpad", "Slang", "Krokodil", "Olifant", "Giraffe", "Leeuw", "Tijger",
            "Aap", "Zebra", "Nijlpaard", "Neushoorn", "Kangoeroe", "Koala", "Panda", "Walvis", "Dolfijn", "Haai", "Kreeft", "Krab",
            "Kwal", "Zeepaardje", "Octopus", "Inktvis", "Varken", "Koe", "Schaap", "Geit", "Paard", "Kip", "Haan", "Kuiken", "Pauw",
            "Flamingo", "Papegaai", "Pelikaan", "Ooievaar", "Mug", "Vlieg", "Wesp", "Mier", "Rups", "Worm", "Dinosaurus", "Draak", "Eenhoorn"
        ],
        "üçî Eten & Drinken": [
            "Pizza", "Patat", "Hamburger", "Pannenkoek", "Ei", "Brood", "Kaas", "Worst", "Melk", "Sap", "Water", "Thee", "Koffie",
            "Taart", "Koekje", "Snoep", "Lolly", "IJsje", "Appel", "Banaan", "Peer", "Druif", "Sinaasappel", "Citroen", "Meloen",
            "Aardbei", "Kers", "Wortel", "Broccoli", "Bloemkool", "Sla", "Tomaat", "Komkommer", "Ui", "Knoflook", "Peper", "Zout",
            "Suiker", "Honing", "Jam", "Pindakaas", "Chocopasta", "Hagelslag", "Beschuit", "Cracker", "Chips", "Popcorn", "Nootjes",
            "Soep", "Pasta", "Rijst", "Sushi", "Taco", "Burrito", "Kebab", "Frikandel", "Kroket", "Bitterbal", "Mayonaise", "Ketchup",
            "Mosterd", "Olijf", "Augurk", "Azijn", "Olie", "Boter", "Yoghurt", "Kwark", "Pap", "Muesli", "Cornflakes", "Visstick"
        ],
        "üè† In & Om Huis": [
            "Huis", "Raam", "Deur", "Sleutel", "Bel", "Dak", "Schoorsteen", "Trap", "Kelder", "Zolder", "Garage", "Tuin", "Hek",
            "Keuken", "Oven", "Magnetron", "Fornuis", "Pan", "Koekenpan", "Spatel", "Garde", "Mixer", "Blender", "Koffiezetapparaat",
            "Waterkoker", "Theepot", "Kopje", "Mok", "Bord", "Bestek", "Mes", "Vork", "Lepel", "Glas", "Vaas", "Bloemen", "Plant",
            "Gieter", "Bank", "Stoel", "Tafel", "Kast", "Bed", "Kussen", "Dekbed", "Lamp", "Wekker", "Klok", "Schilderij", "Spiegel",
            "Bad", "Douche", "Wastafel", "Kraan", "Handdoek", "Zeep", "Tandenborstel", "Tandpasta", "Kam", "Borstel", "F√∂hn",
            "Wasmachine", "Droger", "Strijkijzer", "Stofzuiger", "Bezem", "Emmer", "Dweil", "Spons", "Vuilnisbak", "Televisie",
            "Laptop", "Tablet", "Telefoon", "Oplader", "Stekker", "Stopcontact", "Batterij", "Zaklamp", "Kaars", "Aansteker", "Lucifer"
        ],
        "üëó Kleding & Mode": [
            "Broek", "Trui", "T-shirt", "Overhemd", "Jurk", "Rok", "Jas", "Vest", "Sokken", "Schoenen", "Laarzen", "Pantoffels",
            "Slippers", "Sandalen", "Hakken", "Onderbroek", "Beha", "Pyjama", "Badjas", "Zwembroek", "Bikini", "Badpak", "Muts",
            "Sjaal", "Handschoenen", "Pet", "Hoed", "Helm", "Bril", "Zonnebril", "Horloge", "Armband", "Ketting", "Ring", "Oorbellen",
            "Riem", "Stropdas", "Vlinderdas", "Tas", "Rugzak", "Koffer", "Portemonnee", "Paraplu", "Knop", "Rits", "Zak", "Kraag", "Mouwen"
        ],
        "‚öΩ Sport & Spel": [
            "Voetbal", "Tennis", "Hockey", "Basketbal", "Volleybal", "Honkbal", "Golf", "Rugby", "Boksen", "Judo", "Karate",
            "Zwemmen", "Wielrennen", "Fiets", "Hardlopen", "Atletiek", "Turnen", "Schaatsen", "Ski√´n", "Darten", "Bowlen", "Biljart",
            "Schaken", "Dammen", "Kaarten", "Dobbelsteen", "Puzzel", "Lego", "Pop", "Beer", "Auto", "Trein", "Vliegtuig", "Boot",
            "Vlieger", "Ballon", "Bellenblaas", "Schommel", "Glijbaan", "Wipwap", "Trampoline", "Touwtje springen", "Verstoppertje",
            "Tikkertje", "Doel", "Net", "Racket", "Stick", "Knubbel", "Helm", "Scheidsrechter", "Fluitje", "Beker", "Medaille", "Stadion"
        ],
        "üöí Beroepen & Figuren": [
            "Politie", "Brandweer", "Dokter", "Zuster", "Tandarts", "Dierenarts", "Leraar", "Meester", "Juf", "Kok", "Bakker", "Slager",
            "Boer", "Visser", "Piloot", "Stewardess", "Kapitein", "Piraat", "Astronaut", "Soldaat", "Ridder", "Koning", "Koningin",
            "Prins", "Prinses", "Heks", "Tovenaar", "Geest", "Zombie", "Vampier", "Mummie", "Robot", "Clown", "Acrobaat", "Goochelaar",
            "Zanger", "Danser", "Schilder", "Schrijver", "Fotograaf", "Cameraman", "Regisseur", "Acteur", "Model", "Presentator",
            "Burgemeester", "Rechter", "Advocaat", "Dief", "Boef", "Spion", "Detective", "Postbode", "Vuilnisman", "Bouwvakker", "Timmerman"
        ],
        "üèÉ Acties (Werkwoorden)": [
            "Slapen", "Eten", "Drinken", "Lopen", "Rennen", "Springen", "Zwemmen", "Vliegen", "Fietsen", "Rijden", "Varen", "Zitten",
            "Staan", "Liggen", "Vallen", "Opstaan", "Klimmen", "Dansen", "Zingen", "Schreeuwen", "Fluisteren", "Praten", "Luisteren",
            "Kijken", "Lezen", "Schrijven", "Tekenen", "Schilderen", "Knippen", "Plakken", "Koken", "Bakken", "Wassen", "Strijken",
            "Poetsen", "Dweilen", "Stofzuigen", "Harken", "Graven", "Bouwen", "Slopen", "Repareren", "Gooien", "Vangen", "Schoppen",
            "Slaan", "Vechten", "Knuffelen", "Zoenen", "Zwaaien", "Huilen", "Lachen", "Niezen", "Hoesten", "Gapen", "Denken", "Dromen"
        ]
    };

    const WIN_SCORE = 10;
    const ROUND_TIME = 60;

    let teams = [{ name: "Team 1", score: 0 }, { name: "Team 2", score: 0 }];
    let currentTurn = 0;
    let activeDeck = [];
    let currentWord = "";
    let timerInterval;
    
    // Canvas
    const canvas = document.getElementById('drawingBoard');
    const ctx = canvas.getContext('2d');
    let isDrawing = false;
    let lastX = 0, lastY = 0;
    let strokeColor = '#333';
    let lineWidth = 3;

    // === INIT & SETUP ===
    
    // Vul de categorie√´n in de HTML
    (function initCategories() {
        const container = document.getElementById('category-container');
        for (let cat in wordData) {
            let div = document.createElement('div');
            div.className = 'cat-option selected'; // Standaard alles aan
            div.innerText = cat;
            div.dataset.cat = cat;
            div.onclick = function() { this.classList.toggle('selected'); };
            container.appendChild(div);
        }
    })();

    function toggleAllCats(state) {
        document.querySelectorAll('.cat-option').forEach(el => {
            if(state) el.classList.add('selected');
            else el.classList.remove('selected');
        });
    }

    function initCanvas() {
        // Muis
        canvas.addEventListener('mousedown', startDrawing);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDrawing);
        canvas.addEventListener('mouseout', stopDrawing);
        // Touch
        canvas.addEventListener('touchstart', (e) => {
            e.preventDefault();
            const t = e.touches[0];
            canvas.dispatchEvent(new MouseEvent("mousedown", { clientX: t.clientX, clientY: t.clientY }));
        });
        canvas.addEventListener('touchmove', (e) => {
            e.preventDefault();
            const t = e.touches[0];
            canvas.dispatchEvent(new MouseEvent("mousemove", { clientX: t.clientX, clientY: t.clientY }));
        });
        canvas.addEventListener('touchend', () => canvas.dispatchEvent(new MouseEvent("mouseup", {})));
    }

    function startDrawing(e) { isDrawing = true; [lastX, lastY] = getXY(e); }
    function stopDrawing() { isDrawing = false; }
    function draw(e) {
        if (!isDrawing) return;
        const [x, y] = getXY(e);
        ctx.beginPath(); ctx.moveTo(lastX, lastY); ctx.lineTo(x, y);
        ctx.strokeStyle = strokeColor; ctx.lineWidth = lineWidth;
        ctx.lineCap = 'round'; ctx.lineJoin = 'round'; ctx.stroke();
        [lastX, lastY] = [x, y];
    }
    function getXY(e) {
        const r = canvas.getBoundingClientRect();
        const sx = canvas.width / r.width;
        const sy = canvas.height / r.height;
        return [(e.clientX - r.left) * sx, (e.clientY - r.top) * sy];
    }
    function setColor(c, btn) {
        strokeColor = c;
        document.querySelectorAll('.color-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
    }
    function clearCanvas() { ctx.clearRect(0, 0, canvas.width, canvas.height); }

    // === GAME LOGIC ===

    function startGame() {
        // Teams instellen
        teams[0].name = document.getElementById('input-t1').value || "Team 1";
        teams[1].name = document.getElementById('input-t2').value || "Team 2";
        document.getElementById('name-t1').innerText = teams[0].name;
        document.getElementById('name-t2').innerText = teams[1].name;

        // Deck bouwen op basis van selectie
        activeDeck = [];
        const selectedEls = document.querySelectorAll('.cat-option.selected');
        if (selectedEls.length === 0) { alert("Selecteer minstens √©√©n categorie!"); return; }

        selectedEls.forEach(el => {
            const catName = el.dataset.cat;
            activeDeck = activeDeck.concat(wordData[catName]);
        });

        initCanvas();
        setupTurn();
    }

    function setupTurn() {
        showScreen('screen-preturn');
        document.getElementById('turn-msg').innerText = `‚úèÔ∏è ${teams[currentTurn].name} gaat tekenen!`;
        document.getElementById('secret-word-area').classList.add('hidden');
        clearCanvas();
    }

    function showWord() {
        if (activeDeck.length === 0) {
            alert("De woorden zijn op! We schudden alles opnieuw.");
            // Simpele reload van data als het op is, of gewoon herstarten
            location.reload(); 
            return;
        }
        // Kies random woord uit het 'activeDeck'
        const r = Math.floor(Math.random() * activeDeck.length);
        currentWord = activeDeck[r];
        // Optioneel: verwijder woord uit deck zodat het niet dubbel komt (activeDeck.splice(r, 1))
        // Maar met zoveel woorden is random ook prima en minder kans op 'op raken'.
        
        document.getElementById('word-display').innerText = currentWord;
        document.getElementById('secret-word-area').classList.remove('hidden');
    }

    function startRound() {
        showScreen('screen-game');
        startTimer();
    }

    function startTimer() {
        let timeLeft = ROUND_TIME;
        const bar = document.getElementById('timer-fill');
        bar.style.width = "100%"; bar.style.background = "#2ecc71";
        clearInterval(timerInterval);
        
        timerInterval = setInterval(() => {
            timeLeft--;
            bar.style.width = (timeLeft / ROUND_TIME) * 100 + "%";
            if(timeLeft < 20) bar.style.background = "orange";
            if(timeLeft < 10) bar.style.background = "#b01c1e";
            if(timeLeft <= 0) clearInterval(timerInterval);
        }, 1000);
    }

    function endRound(success) {
        clearInterval(timerInterval);
        if(success) {
            teams[currentTurn].score++;
            document.getElementById('score-t1').innerText = teams[0].score;
            document.getElementById('score-t2').innerText = teams[1].score;
            if(teams[currentTurn].score >= WIN_SCORE) { showWinner(); return; }
        }
        currentTurn = currentTurn === 0 ? 1 : 0;
        setupTurn();
    }

    function showWinner() {
        showScreen('screen-winner');
        document.getElementById('winner-name').innerText = teams[currentTurn].name;
        fireConfetti();
    }

    function showScreen(id) {
        ['screen-setup', 'screen-preturn', 'screen-game', 'screen-winner'].forEach(s => document.getElementById(s).classList.add('hidden'));
        document.getElementById(id).classList.remove('hidden');
    }

    // === EFFECTS ===
    function createSnow() {
        for(let i=0; i<30; i++) {
            let s = document.createElement('div');
            s.className = 'snowflake'; s.innerHTML = '‚ùÑ';
            s.style.left = Math.random()*100+'vw';
            s.style.animationDuration = (Math.random()*5+3)+'s';
            s.style.fontSize = (Math.random()*15+8)+'px';
            document.body.appendChild(s);
        }
    }
    createSnow();

    function fireConfetti() {
        const c = document.getElementById('confetti-canvas');
        const x = c.getContext('2d');
        c.width = window.innerWidth; c.height = window.innerHeight;
        let p = [];
        const cols = ['#d42426', '#165b33', '#f8b229', '#ffffff'];
        for(let i=0; i<300; i++) p.push({
            x: c.width/2, y: c.height/2, w: Math.random()*10+5, h: Math.random()*10+5,
            c: cols[Math.floor(Math.random()*cols.length)], vx: (Math.random()-0.5)*30, vy: (Math.random()-0.5)*30
        });
        function u() {
            x.clearRect(0,0,c.width,c.height);
            p = p.filter(i => i.y < c.height);
            p.forEach(i => { i.x+=i.vx; i.y+=i.vy; i.vy+=0.2; i.vx*=0.96; x.fillStyle=i.c; x.fillRect(i.x,i.y,i.w,i.h); });
            if(p.length>0) requestAnimationFrame(u);
        }
        u();
    }
</script>

</body>
</html>